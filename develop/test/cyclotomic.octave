format long
function retval = mobius (n) 
  if (n == 1)
    retval = 1;
  endif
  [pf,m] = factor(n);
  distinct = true;
  for i = m
    if (i>1)
      distinct=false;
    endif
  endfor
  if (distinct)
    retval = (-1)^(length(m));
  else
    retval = 0;
  endif
endfunction

function retval = truthCombinations(k)
  retval=[true; false];
  for i = 1:k-1
    a = retval;
    n = rows(retval);
    m = columns(retval);
    retval = zeros(2*n, m+1);
    for j = 1:n
      retval(j,:) = [a(j,:) true];
      retval(n+j,:) = [a(j,:) false];
    endfor  
  endfor
endfunction

function retval = divisors(n)
  retval = [];
  [pf, m] = factor(n);
  pff = [];
  if (length([pf])==1&&m==1)
    return;
  endif
  for i = 1:length(m)
    for k = 1:m(i)
      pff = [pff pf(i)];
    endfor
  endfor
  combos = truthCombinations(length(pff));

  for i = 1:rows(combos)
    v = [];
    for j = 1:columns(combos)
      if(combos(i,j))
        v = [v pff(j)];
      endif
    endfor
    a = prod(v);
    if (a<n)
      retval = [retval a];
    endif
  endfor
  retval = unique(retval);
  retval = retval(2:end);
endfunction



function retval = rootsOfUnity(n)
  ds = divisors(n);
  zs = [];
  for i=1:length(ds)
    d = ds(i);
    z = exp((2i*pi*d)/n);
    zs = [zs z];
  endfor
  retval = [];
  for i=1:length(zs)
    z = zs(i);
    for j = 1:length(ds)
      d = ds(j);
      x = cos((z+2*pi*d)/n) + 1i*sin((z+2*pi*d)/n);
      r = cos(x)+i*sin(x);
      retval = [retval r];
    endfor
  endfor
endfunction
rootsOfUnity(10)

rs= rootsOfUnity(10)
polar(rs)

function retval = zplot(ps)
  hold on;
  t = linspace(0,2*pi,100)'; 
  r = 1;
  circsx = r.*cos(t); 
  circsy = r.*sin(t); 
  plot(circsx,circsy); 
  for i=1:length(ps)
    p = ps(i);
    x = real(p);
    y = imag(p);
    plot(x,y)
  endfor
  hold off;
endfunction












!function retval = cyclotomic(n)
!  ds = divisors(n);
!  for i = 1:length(ds)
!    d = ds(i);
!    m = mobius(d);  
!    if(m==0)
!      continue
!    endifx
!    exponent = n/d; 
!    !@TODO 
!  endfor
!endfunction
!cyclotomic(6)



